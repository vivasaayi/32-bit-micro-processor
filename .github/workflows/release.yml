name: Create Release

on:
  workflow_dispatch:
    inputs:
      tag_name:
        description: 'Release tag (e.g., v1.0.0)'
        required: true
        type: string
      release_name:
        description: 'Release name'
        required: true
        type: string
      body:
        description: 'Release description'
        required: false
        type: textarea
        default: |
          ## AruviXPlatform Release

          This release contains cross-platform JARs for the AruviXPlatform IDE.

          ### Downloads
          - **Linux**: `AruviXPlatform-JAR-Linux.jar` - For Linux x64 systems
          - **Windows**: `AruviXPlatform-JAR-Windows.jar` - For Windows x64 systems
          - **macOS**: `AruviXPlatform-JAR-macOS.jar` - For macOS x64 systems

          ### Features
          - Complete AruviXPlatform ecosystem in a single JAR
          - Platform-specific binaries included
          - Run with: `java -jar AruviXPlatform-JAR-<platform>.jar`

jobs:
  create-release:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Download Linux JAR
      uses: actions/download-artifact@v4
      with:
        name: AruviXPlatform-JAR-Linux
        path: ./artifacts/linux/

    - name: Download Windows JAR
      uses: actions/download-artifact@v4
      with:
        name: AruviXPlatform-JAR-Windows
        path: ./artifacts/windows/

    - name: Download macOS JAR
      uses: actions/download-artifact@v4
      with:
        name: AruviXPlatform-JAR-macOS
        path: ./artifacts/macos/

    - name: List downloaded artifacts
      run: |
        echo "=== Downloaded Artifacts ==="
        find ./artifacts/ -name "*.jar" -exec ls -lh {} \;

    - name: Create Release
      id: create_release
      uses: softprops/action-gh-release@v1
      with:
        tag_name: ${{ inputs.tag_name }}
        name: ${{ inputs.release_name }}
        body: ${{ inputs.body }}
        draft: false
        prerelease: false
        files: |
          ./artifacts/linux/AruviIDE-1.0-SNAPSHOT.jar#AruviXPlatform-JAR-Linux.jar
          ./artifacts/windows/AruviIDE-1.0-SNAPSHOT.jar#AruviXPlatform-JAR-Windows.jar
          ./artifacts/macos/AruviIDE-1.0-SNAPSHOT.jar#AruviXPlatform-JAR-macOS.jar